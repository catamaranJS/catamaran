"use strict";function _interopRequireWildcard(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var _ces=require("ces"),CES=_interopRequireWildcard(_ces),_libBabylon=require("../lib/babylon"),BABYLON=_interopRequireWildcard(_libBabylon),_utilsUtils=require("../utils/utils"),defaults=_utilsUtils.utils.defaultArgs();defaults._name="portal";var c_portal=function t(){var e=arguments.length<=0||void 0===arguments[0]?defaults:arguments[0];_classCallCheck(this,t),this.name=e._name+_utilsUtils.utils.guid(),this.scene=e._scene,this.obj=null,this.plane=null,this.hadFired=!1,this.portalImg=e._portalImg,this._href=e._href,this._portalPosition=e._portalPosition,BABYLON.SceneLoader.ImportMesh("","/assets/scene/","portal.babylon",this.scene,function(t){this.obj=t[0],this.obj.scaling.x=this.obj.scaling.y=this.obj.scaling.z=3,this.plane=BABYLON.Mesh.CreatePlane("plane",.5,scene),this.plane.position.y=1,this.plane.parent=t[0],t[1].parent=t[0],t[2].parent=t[0],t[3].parent=t[0];for(var i=0;i<t.length;i++)t[i].checkCollisions=!0;var s=new BABYLON.StandardMaterial("portalImg",this.scene);s.diffuseTexture=new BABYLON.Texture(this.portalImg,this.scene),s.backFaceCulling=!1,this.plane.material=s,this.obj.layerMask=parseInt(e._layerMask),this.obj.isPickable=e._isPickable,this.obj.position=e._position,this.obj.rotation=e._rotation,this.options={name:this.name,init:this.constructor,plane:this.plane,obj:this.obj};for(var i=0;i<this.scene.cameras.length;i++)this.scene.cameras[i].onCollide=function(i){i.uniqueId!=t[2].uniqueId||this.hadFired||null!=this._portalPosition?null!=this._portalPosition&&(this.scene.activeCamera.position=_utilsUtils.utils.getVector(this._portalPosition)):(this.hadFired=!0,window.location=e._href)};CES.Component.extend(this.options)}.bind(this))};exports.c_portal=c_portal;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvbHNkL2NvbXBvbmVudHMvY19wb3J0YWwuanMiXSwibmFtZXMiOlsiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJvYmoiLCJfX2VzTW9kdWxlIiwibmV3T2JqIiwia2V5IiwiT2JqZWN0IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsInZhbHVlIiwiX2NlcyIsInJlcXVpcmUiLCJDRVMiLCJfbGliQmFieWxvbiIsIkJBQllMT04iLCJfdXRpbHNVdGlscyIsImRlZmF1bHRzIiwidXRpbHMiLCJkZWZhdWx0QXJncyIsIl9uYW1lIiwiY19wb3J0YWwiLCJfb3B0cyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInRoaXMiLCJuYW1lIiwiZ3VpZCIsInNjZW5lIiwiX3NjZW5lIiwicGxhbmUiLCJoYWRGaXJlZCIsInBvcnRhbEltZyIsIl9wb3J0YWxJbWciLCJfaHJlZiIsIl9wb3J0YWxQb3NpdGlvbiIsIlNjZW5lTG9hZGVyIiwiSW1wb3J0TWVzaCIsIm5ld01lc2hlcyIsInNjYWxpbmciLCJ4IiwieSIsInoiLCJNZXNoIiwiQ3JlYXRlUGxhbmUiLCJwb3NpdGlvbiIsInBhcmVudCIsImkiLCJjaGVja0NvbGxpc2lvbnMiLCJtYXRlcmlhbFBsYW5lIiwiU3RhbmRhcmRNYXRlcmlhbCIsImRpZmZ1c2VUZXh0dXJlIiwiVGV4dHVyZSIsImJhY2tGYWNlQ3VsbGluZyIsIm1hdGVyaWFsIiwibGF5ZXJNYXNrIiwicGFyc2VJbnQiLCJfbGF5ZXJNYXNrIiwiaXNQaWNrYWJsZSIsIl9pc1BpY2thYmxlIiwiX3Bvc2l0aW9uIiwicm90YXRpb24iLCJfcm90YXRpb24iLCJvcHRpb25zIiwiaW5pdCIsImNvbnN0cnVjdG9yIiwiY2FtZXJhcyIsIm9uQ29sbGlkZSIsImNvbE1lc2giLCJ1bmlxdWVJZCIsImFjdGl2ZUNhbWVyYSIsImdldFZlY3RvciIsIndpbmRvdyIsImxvY2F0aW9uIiwiQ29tcG9uZW50IiwiZXh0ZW5kIiwiYmluZCJdLCJtYXBwaW5ncyI6IkFBQUEsWUFNQSxTQUFTQSx5QkFBd0JDLEdBQU8sR0FBSUEsR0FBT0EsRUFBSUMsV0FBYyxNQUFPRCxFQUFjLElBQUlFLEtBQWEsSUFBVyxNQUFQRixFQUFlLElBQUssR0FBSUcsS0FBT0gsR0FBV0ksT0FBT0MsVUFBVUMsZUFBZUMsS0FBS1AsRUFBS0csS0FBTUQsRUFBT0MsR0FBT0gsRUFBSUcsR0FBbUMsT0FBekJELEdBQU8sV0FBYUYsRUFBWUUsRUFFclEsUUFBU00saUJBQWdCQyxFQUFVQyxHQUFlLEtBQU1ELFlBQW9CQyxJQUFnQixLQUFNLElBQUlDLFdBQVUscUNBTmhIUCxPQUFPUSxlQUFlQyxRQUFTLGNBQzlCQyxPQUFPLEdBT1IsSUFBSUMsTUFBT0MsUUFWVSxPQUFUQyxJQUFHbEIsd0JBQUFnQixNQWNYRyxZQUFjRixRQWJPLGtCQUFiRyxRQUFPcEIsd0JBQUFtQixhQWlCZkUsWUFBY0osUUFoQkksa0JBQ2xCSyxTQUFXRCxZQUFBRSxNQUFNQyxhQUNyQkYsVUFBU0csTUFBUSxRQXlCakIsSUFsQmFDLFVBQ0QsUUFEQ0EsS0FtQlosR0FsQllDLEdBQUtDLFVBQUFDLFFBQUEsR0FBQUMsU0FBQUYsVUFBQSxHQUFHTixTQUFRTSxVQUFBLEVBb0I1Qm5CLGlCQUFnQnNCLEtBckJKTCxHQUVYSyxLQUFLQyxLQUFPTCxFQUFNRixNQUFRSixZQUFBRSxNQUFNVSxPQUNoQ0YsS0FBS0csTUFBU1AsRUFBTVEsT0FDcEJKLEtBQUs5QixJQUFNLEtBQ1g4QixLQUFLSyxNQUFRLEtBQ2JMLEtBQUtNLFVBQVcsRUFDaEJOLEtBQUtPLFVBQVlYLEVBQU1ZLFdBQ3ZCUixLQUFLUyxNQUFRYixFQUFNYSxNQUNuQlQsS0FBS1UsZ0JBQWtCZCxFQUFNYyxnQkFFN0JyQixRQUFRc0IsWUFBWUMsV0FBVyxHQUFJLGlCQUFrQixpQkFBa0JaLEtBQUtHLE1BQVEsU0FBVVUsR0FDaEZiLEtBQUs5QixJQUFPMkMsRUFBVSxHQUN0QmIsS0FBSzlCLElBQUk0QyxRQUFRQyxFQUFJZixLQUFLOUIsSUFBSTRDLFFBQVFFLEVBQUloQixLQUFLOUIsSUFBSTRDLFFBQVFHLEVBQUksRUFDL0RqQixLQUFLSyxNQUFRaEIsUUFBUTZCLEtBQUtDLFlBQVksUUFBUyxHQUFLaEIsT0FDdkRILEtBQUtLLE1BQU1lLFNBQVNKLEVBQUssRUFDekJoQixLQUFLSyxNQUFNZ0IsT0FBU1IsRUFBVSxHQUM5QkEsRUFBVSxHQUFHUSxPQUFTUixFQUFVLEdBQ2hDQSxFQUFVLEdBQUdRLE9BQVNSLEVBQVUsR0FDaENBLEVBQVUsR0FBR1EsT0FBU1IsRUFBVSxFQUNoQyxLQUFJLEdBQUlTLEdBQUksRUFBR0EsRUFBSVQsRUFBVWYsT0FBUXdCLElBQ3BDVCxFQUFVUyxHQUFHQyxpQkFBa0IsQ0FFaEMsSUFBSUMsR0FBZ0IsR0FBSW5DLFNBQVFvQyxpQkFBaUIsWUFBYXpCLEtBQUtHLE1BQ25FcUIsR0FBY0UsZUFBaUIsR0FBSXJDLFNBQVFzQyxRQUFRM0IsS0FBS08sVUFBV1AsS0FBS0csT0FDeEVxQixFQUFjSSxpQkFBa0IsRUFDaEM1QixLQUFLSyxNQUFNd0IsU0FBV0wsRUFDdEJ4QixLQUFLOUIsSUFBSTRELFVBQVlDLFNBQVNuQyxFQUFNb0MsWUFDN0NoQyxLQUFLOUIsSUFBSStELFdBQWFyQyxFQUFNc0MsWUFDNUJsQyxLQUFLOUIsSUFBSWtELFNBQVd4QixFQUFNdUMsVUFDMUJuQyxLQUFLOUIsSUFBSWtFLFNBQVd4QyxFQUFNeUMsVUFDMUJyQyxLQUFLc0MsU0FDSnJDLEtBQUtELEtBQUtDLEtBQ1ZzQyxLQUFNdkMsS0FBS3dDLFlBQ1huQyxNQUFPTCxLQUFLSyxNQUNabkMsSUFBSThCLEtBQUs5QixJQUVWLEtBQUksR0FBSW9ELEdBQUksRUFBR0EsRUFBSXRCLEtBQUtHLE1BQU1zQyxRQUFRM0MsT0FBUXdCLElBQzdDdEIsS0FBS0csTUFBTXNDLFFBQVFuQixHQUFHb0IsVUFBWSxTQUFVQyxHQUN2Q0EsRUFBUUMsVUFBWS9CLEVBQVUsR0FBRytCLFVBQWE1QyxLQUFLTSxVQUFvQyxNQUF4Qk4sS0FBS1UsZ0JBSTVDLE1BQXhCVixLQUFLVSxrQkFDUFYsS0FBS0csTUFBTTBDLGFBQWF6QixTQUFXOUIsWUFBQUUsTUFBTXNELFVBQVU5QyxLQUFLVSxtQkFKekRWLEtBQUtNLFVBQVcsRUFDaEJ5QyxPQUFPQyxTQUFXcEQsRUFBTWEsT0FRM0J0QixLQUFJOEQsVUFBVUMsT0FBT2xELEtBQUtzQyxVQUNuQmEsS0FBS25ELE9Bd0JoQmpCLFNBQVFZLFNBQVdBIiwiZmlsZSI6ImNvcmUvbHNkL2NvbXBvbmVudHMvY19wb3J0YWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBDRVMgZnJvbSAnY2VzJztcbmltcG9ydCAqIGFzIEJBQllMT04gZnJvbSAnLi4vbGliL2JhYnlsb24nO1xuaW1wb3J0IHsgdXRpbHMgfSBmcm9tICcuLi91dGlscy91dGlscyc7XG52YXIgZGVmYXVsdHMgPSB1dGlscy5kZWZhdWx0QXJncygpO1xuZGVmYXVsdHMuX25hbWUgPSAncG9ydGFsJztcbi8qKlxuICogLi4uXG4gKiBAYXV0aG9yIEJyZW5kb24gU21pdGhcbiAqIGh0dHA6Ly9zZWFjbG91ZDkub3JnXG4gKiBMaWdodFdlaWdodCAzRCBTeXN0ZW0gRGVzaWduIGVuZ2luZVxuICovXG5leHBvcnQgY2xhc3MgY19wb3J0YWwge1xuXHRjb25zdHJ1Y3Rvcihfb3B0cyA9IGRlZmF1bHRzKXtcblx0XHR0aGlzLm5hbWUgPSBfb3B0cy5fbmFtZSArIHV0aWxzLmd1aWQoKTtcblx0XHR0aGlzLnNjZW5lID0gIF9vcHRzLl9zY2VuZTtcblx0XHR0aGlzLm9iaiA9IG51bGw7XG5cdFx0dGhpcy5wbGFuZSA9IG51bGw7XG5cdFx0dGhpcy5oYWRGaXJlZCA9IGZhbHNlO1xuXHRcdHRoaXMucG9ydGFsSW1nID0gX29wdHMuX3BvcnRhbEltZztcblx0XHR0aGlzLl9ocmVmID0gX29wdHMuX2hyZWY7XG5cdFx0dGhpcy5fcG9ydGFsUG9zaXRpb24gPSBfb3B0cy5fcG9ydGFsUG9zaXRpb247XG5cblx0XHRCQUJZTE9OLlNjZW5lTG9hZGVyLkltcG9ydE1lc2goXCJcIiwgXCIvYXNzZXRzL3NjZW5lL1wiLCBcInBvcnRhbC5iYWJ5bG9uXCIsIHRoaXMuc2NlbmUgLCBmdW5jdGlvbiAobmV3TWVzaGVzKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vYmogID0gbmV3TWVzaGVzWzBdO1xuICAgICAgICAgICAgICAgIHRoaXMub2JqLnNjYWxpbmcueCA9IHRoaXMub2JqLnNjYWxpbmcueSA9IHRoaXMub2JqLnNjYWxpbmcueiA9IDM7XG4gICAgICAgICAgICAgICAgdGhpcy5wbGFuZSA9IEJBQllMT04uTWVzaC5DcmVhdGVQbGFuZShcInBsYW5lXCIsIDAuNSwgc2NlbmUpO1xuICAgICAgICAgICAgXHR0aGlzLnBsYW5lLnBvc2l0aW9uLnkgPSAgMTtcbiAgICAgICAgICAgIFx0dGhpcy5wbGFuZS5wYXJlbnQgPSBuZXdNZXNoZXNbMF07XG4gICAgICAgICAgICBcdG5ld01lc2hlc1sxXS5wYXJlbnQgPSBuZXdNZXNoZXNbMF07XG4gICAgICAgICAgICBcdG5ld01lc2hlc1syXS5wYXJlbnQgPSBuZXdNZXNoZXNbMF07XG4gICAgICAgICAgICBcdG5ld01lc2hlc1szXS5wYXJlbnQgPSBuZXdNZXNoZXNbMF07XG4gICAgICAgICAgICBcdGZvcihsZXQgaSA9IDA7IGkgPCBuZXdNZXNoZXMubGVuZ3RoOyBpKyspe1xuICAgICAgICAgICAgXHRcdG5ld01lc2hlc1tpXS5jaGVja0NvbGxpc2lvbnMgPSB0cnVlO1xuICAgICAgICAgICAgXHR9XG5cdCAgICAgICAgICAgIHZhciBtYXRlcmlhbFBsYW5lID0gbmV3IEJBQllMT04uU3RhbmRhcmRNYXRlcmlhbChcInBvcnRhbEltZ1wiLCB0aGlzLnNjZW5lKTtcblx0ICAgICAgICAgICAgbWF0ZXJpYWxQbGFuZS5kaWZmdXNlVGV4dHVyZSA9IG5ldyBCQUJZTE9OLlRleHR1cmUodGhpcy5wb3J0YWxJbWcsIHRoaXMuc2NlbmUpO1xuXHQgICAgICAgICAgICBtYXRlcmlhbFBsYW5lLmJhY2tGYWNlQ3VsbGluZyA9IGZhbHNlO1xuXHQgICAgICAgICAgICB0aGlzLnBsYW5lLm1hdGVyaWFsID0gbWF0ZXJpYWxQbGFuZTtcblx0ICAgICAgICAgICAgdGhpcy5vYmoubGF5ZXJNYXNrID0gcGFyc2VJbnQoX29wdHMuX2xheWVyTWFzayk7XG5cdFx0XHRcdHRoaXMub2JqLmlzUGlja2FibGUgPSBfb3B0cy5faXNQaWNrYWJsZTtcblx0XHRcdFx0dGhpcy5vYmoucG9zaXRpb24gPSBfb3B0cy5fcG9zaXRpb247XG5cdFx0XHRcdHRoaXMub2JqLnJvdGF0aW9uID0gX29wdHMuX3JvdGF0aW9uO1xuXHRcdFx0XHR0aGlzLm9wdGlvbnMgPSB7XG5cdFx0XHRcdFx0bmFtZTp0aGlzLm5hbWUgLFxuXHRcdFx0XHRcdGluaXQ6IHRoaXMuY29uc3RydWN0b3IsXG5cdFx0XHRcdFx0cGxhbmU6IHRoaXMucGxhbmUsXG5cdFx0XHRcdFx0b2JqOnRoaXMub2JqXG5cdFx0XHRcdH1cblx0XHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IHRoaXMuc2NlbmUuY2FtZXJhcy5sZW5ndGg7IGkrKyl7XG5cdFx0XHRcdFx0dGhpcy5zY2VuZS5jYW1lcmFzW2ldLm9uQ29sbGlkZSA9IGZ1bmN0aW9uIChjb2xNZXNoKSB7XG5cdFx0XHRcdFx0XHRpZiAoY29sTWVzaC51bmlxdWVJZCA9PSBuZXdNZXNoZXNbMl0udW5pcXVlSWQgJiYgIXRoaXMuaGFkRmlyZWQgJiYgdGhpcy5fcG9ydGFsUG9zaXRpb24gPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLmhhZEZpcmVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uID0gX29wdHMuX2hyZWY7XG5cdFx0XHRcdFx0XHR9ZWxzZXtcblx0XHRcdFx0XHRcdFx0aWYodGhpcy5fcG9ydGFsUG9zaXRpb24gIT0gbnVsbCl7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5zY2VuZS5hY3RpdmVDYW1lcmEucG9zaXRpb24gPSB1dGlscy5nZXRWZWN0b3IodGhpcy5fcG9ydGFsUG9zaXRpb24pO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVx0XG5cdFx0XHRcdH1cblx0XHRcdFx0Q0VTLkNvbXBvbmVudC5leHRlbmQodGhpcy5vcHRpb25zKTtcbiAgICAgICAgIH0uYmluZCh0aGlzKSk7XG5cdH1cblxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==