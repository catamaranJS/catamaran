"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,i,r){return i&&t(e.prototype,i),r&&t(e,r),e}}(),_get=function(t,e,i){for(var r=!0;r;){var n=t,s=e,o=i;r=!1,null===n&&(n=Function.prototype);var a=Object.getOwnPropertyDescriptor(n,s);if(void 0!==a){if("value"in a)return a.value;var u=a.get;return void 0===u?void 0:u.call(o)}var c=Object.getPrototypeOf(n);if(null===c)return void 0;t=c,e=s,i=o,r=!0,a=c=void 0}},CES=require("CES"),BABYLON=require("../lib/babylon"),s_multiuser=function(t){function e(t){_classCallCheck(this,e),_get(Object.getPrototypeOf(e.prototype),"constructor",this).call(this),this._opts=t,this._entity=null,this._zombieModeEnabled=!1}return _inherits(e,t),_createClass(e,[{key:"update",value:function(t){var e=this.world.getEntities("multiuser");e.forEach(function(t){if(this._entity=t._components.$multiuser,this.world._crurrentScene.activeCamera&&this._entity.sysInit&&this._entity.userInit){this._entity.updateUser(this.world._crurrentScene.activeCameras[0].position,this.world._crurrentScene.activeCameras[0].rotation);for(var e=0;e<this._entity.currentUsers.length;e++)this._entity.currentUsers[e].key!=this._entity.currentUserKey&&(this.spriteDoesNotExist(this._entity.currentUsers[e].key,this._entity.sprites)?(this._zombieModeEnabled=this._entity.zombieMode?!0:!1,this.updateUserSprites(this._entity.currentUsers[e])):this._entity.generateUserSprites(this._entity.currentUsers[e],e))}}.bind(this))}},{key:"spriteDoesNotExist",value:function(t,e){for(var i=!1,r=0;r<e.length;r++)if(e[r].key==t)return i=!0;return i}},{key:"updateUserSprites",value:function(t){for(var e=0;e<this._entity.sprites.length;e++)if(void 0!=this._entity.sprites[e].key&&t.key==this._entity.sprites[e].key){this._entity.zombieMode?this._entity.sprites[e].sprite.playAnimation(80,100,!0,100):this._zombieModeEnabled&&this._entity.sprites[e].sprite.playAnimation(Math.abs(20-parseInt(t.data.spriteID)),parseInt(t.data.spriteID),!0,100),this._entity.sprites[e].sprite.position=t.data.position;break}}}]),e}(CES.System);module.exports=s_multiuser;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvcmUvbHNkL3N5c3RlbXMvc19tdWx0aXVzZXIuanMiXSwibmFtZXMiOlsiX2NsYXNzQ2FsbENoZWNrIiwiaW5zdGFuY2UiLCJDb25zdHJ1Y3RvciIsIlR5cGVFcnJvciIsIl9pbmhlcml0cyIsInN1YkNsYXNzIiwic3VwZXJDbGFzcyIsInByb3RvdHlwZSIsIk9iamVjdCIsImNyZWF0ZSIsImNvbnN0cnVjdG9yIiwidmFsdWUiLCJlbnVtZXJhYmxlIiwid3JpdGFibGUiLCJjb25maWd1cmFibGUiLCJzZXRQcm90b3R5cGVPZiIsIl9fcHJvdG9fXyIsIl9jcmVhdGVDbGFzcyIsImRlZmluZVByb3BlcnRpZXMiLCJ0YXJnZXQiLCJwcm9wcyIsImkiLCJsZW5ndGgiLCJkZXNjcmlwdG9yIiwiZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJwcm90b1Byb3BzIiwic3RhdGljUHJvcHMiLCJfZ2V0IiwiX3giLCJfeDIiLCJfeDMiLCJfYWdhaW4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInJlY2VpdmVyIiwiRnVuY3Rpb24iLCJkZXNjIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidW5kZWZpbmVkIiwiZ2V0dGVyIiwiZ2V0IiwiY2FsbCIsInBhcmVudCIsImdldFByb3RvdHlwZU9mIiwiQ0VTIiwicmVxdWlyZSIsIkJBQllMT04iLCJzX211bHRpdXNlciIsIl9DRVMkU3lzdGVtIiwiX29wdHMiLCJ0aGlzIiwiX2VudGl0eSIsIl96b21iaWVNb2RlRW5hYmxlZCIsImR0IiwiZW50aXRpZXMiLCJ3b3JsZCIsImdldEVudGl0aWVzIiwiZm9yRWFjaCIsImVudGl0eSIsIl9jb21wb25lbnRzIiwiJG11bHRpdXNlciIsIl9jcnVycmVudFNjZW5lIiwiYWN0aXZlQ2FtZXJhIiwic3lzSW5pdCIsInVzZXJJbml0IiwidXBkYXRlVXNlciIsImFjdGl2ZUNhbWVyYXMiLCJwb3NpdGlvbiIsInJvdGF0aW9uIiwiY3VycmVudFVzZXJzIiwiY3VycmVudFVzZXJLZXkiLCJzcHJpdGVEb2VzTm90RXhpc3QiLCJzcHJpdGVzIiwiem9tYmllTW9kZSIsInVwZGF0ZVVzZXJTcHJpdGVzIiwiZ2VuZXJhdGVVc2VyU3ByaXRlcyIsImJpbmQiLCJhcnJheSIsImZvdW5kIiwiX2RhdGEiLCJzcHJpdGUiLCJwbGF5QW5pbWF0aW9uIiwiTWF0aCIsImFicyIsInBhcnNlSW50IiwiZGF0YSIsInNwcml0ZUlEIiwiU3lzdGVtIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFNQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0FFaEgsUUFBU0MsV0FBVUMsRUFBVUMsR0FBYyxHQUEwQixrQkFBZkEsSUFBNEMsT0FBZkEsRUFBdUIsS0FBTSxJQUFJSCxXQUFVLGlFQUFvRUcsR0FBZUQsR0FBU0UsVUFBWUMsT0FBT0MsT0FBT0gsR0FBY0EsRUFBV0MsV0FBYUcsYUFBZUMsTUFBT04sRUFBVU8sWUFBWSxFQUFPQyxVQUFVLEVBQU1DLGNBQWMsS0FBZVIsSUFBWUUsT0FBT08sZUFBaUJQLE9BQU9PLGVBQWVWLEVBQVVDLEdBQWNELEVBQVNXLFVBQVlWLEdBTmplLEdBQUlXLGNBQWUsV0FBZSxRQUFTQyxHQUFpQkMsRUFBUUMsR0FBUyxJQUFLLEdBQUlDLEdBQUksRUFBR0EsRUFBSUQsRUFBTUUsT0FBUUQsSUFBSyxDQUFFLEdBQUlFLEdBQWFILEVBQU1DLEVBQUlFLEdBQVdYLFdBQWFXLEVBQVdYLGFBQWMsRUFBT1csRUFBV1QsY0FBZSxFQUFVLFNBQVdTLEtBQVlBLEVBQVdWLFVBQVcsR0FBTUwsT0FBT2dCLGVBQWVMLEVBQVFJLEVBQVdFLElBQUtGLElBQWlCLE1BQU8sVUFBVXJCLEVBQWF3QixFQUFZQyxHQUFpSixNQUE5SEQsSUFBWVIsRUFBaUJoQixFQUFZSyxVQUFXbUIsR0FBaUJDLEdBQWFULEVBQWlCaEIsRUFBYXlCLEdBQXFCekIsTUFFN2hCMEIsS0FBTyxTQUFhQyxFQUFJQyxFQUFLQyxHQUFxQyxJ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RUFBTU0sS0FBS0MsV0FBYUYsU0FBU0wsRUFBTU0sS0FBS0MsV0FBVyxFQUFNLEtBRzFJcEMsS0FBS0MsUUFBUXFCLFFBQVFwRCxHQUFHNEQsT0FBT2IsU0FBWVksRUFBTU0sS0FBS2xCLFFBQ3RELFlBeERUcEIsR0FBb0JILElBQUkyQyxPQThEL0JDLFFBQU9DLFFBQVUxQyIsImZpbGUiOiJjb3JlL2xzZC9zeXN0ZW1zL3NfbXVsdGl1c2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG52YXIgQ0VTID0gcmVxdWlyZSgnQ0VTJyk7XG52YXIgQkFCWUxPTiA9IHJlcXVpcmUoJy4uL2xpYi9iYWJ5bG9uJyk7XG5cbi8qKlxuICogLi4uXG4gKiBAYXV0aG9yIEJyZW5kb24gU21pdGhcbiAqIGh0dHA6Ly9zZWFjbG91ZDkub3JnXG4gKiBMaWdodFdlaWdodCAzRCBTeXN0ZW0gRGVzaWduIGVuZ2luZVxuICovXG4gY2xhc3Mgc19tdWx0aXVzZXIgZXh0ZW5kcyBDRVMuU3lzdGVte1xuICAgIGNvbnN0cnVjdG9yKF9vcHRzKXtcbiAgICAgICAgc3VwZXIoKTtcbiAgICAgICAgdGhpcy5fb3B0cyA9IF9vcHRzO1xuICAgICAgICB0aGlzLl9lbnRpdHkgPSBudWxsO1xuICAgICAgICB0aGlzLl96b21iaWVNb2RlRW5hYmxlZCA9IGZhbHNlO1xuICAgIH1cblxuICAgIHVwZGF0ZShkdCl7XG4gICAgICB2YXIgZW50aXRpZXMgPSB0aGlzLndvcmxkLmdldEVudGl0aWVzKCdtdWx0aXVzZXInKTtcbiAgICAgIGVudGl0aWVzLmZvckVhY2goZnVuY3Rpb24gKGVudGl0eSkge1xuICAgICAgICB0aGlzLl9lbnRpdHkgID0gZW50aXR5Ll9jb21wb25lbnRzLiRtdWx0aXVzZXI7XG4gICAgICAgIGlmKHRoaXMud29ybGQuX2NydXJyZW50U2NlbmUuYWN0aXZlQ2FtZXJhICYmIHRoaXMuX2VudGl0eS5zeXNJbml0ICYmIHRoaXMuX2VudGl0eS51c2VySW5pdCl7XG4gICAgICAgICAgICB0aGlzLl9lbnRpdHkudXBkYXRlVXNlcih0aGlzLndvcmxkLl9jcnVycmVudFNjZW5lLmFjdGl2ZUNhbWVyYXNbMF0ucG9zaXRpb24sIHRoaXMud29ybGQuX2NydXJyZW50U2NlbmUuYWN0aXZlQ2FtZXJhc1swXS5yb3RhdGlvbik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGZvcihsZXQgaSA9IDA7IGkgPCB0aGlzLl9lbnRpdHkuY3VycmVudFVzZXJzLmxlbmd0aDsgaSsrKXtcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9lbnRpdHkuY3VycmVudFVzZXJzW2ldLmtleSAhPSB0aGlzLl9lbnRpdHkuY3VycmVudFVzZXJLZXkpe1xuICAgICAgICAgICAgICAgICAgICBpZighIHRoaXMuc3ByaXRlRG9lc05vdEV4aXN0KHRoaXMuX2VudGl0eS5jdXJyZW50VXNlcnNbaV0ua2V5LCB0aGlzLl9lbnRpdHkuc3ByaXRlcykpe1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW50aXR5LmdlbmVyYXRlVXNlclNwcml0ZXModGhpcy5fZW50aXR5LmN1cnJlbnRVc2Vyc1tpXSwgaSk7XG4gICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5fZW50aXR5LnpvbWJpZU1vZGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3pvbWJpZU1vZGVFbmFibGVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3pvbWJpZU1vZGVFbmFibGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZVVzZXJTcHJpdGVzKHRoaXMuX2VudGl0eS5jdXJyZW50VXNlcnNbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfVxuXG4gICAgc3ByaXRlRG9lc05vdEV4aXN0KHZhbHVlLCBhcnJheSkge1xuICAgICAgICB2YXIgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgZm9yKHZhciBpID0gMDsgaSA8IGFycmF5Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoYXJyYXlbaV0ua2V5ID09IHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZm91bmQ7XG4gICAgfVxuXG5cbiAgICB1cGRhdGVVc2VyU3ByaXRlcyhfZGF0YSl7XG4gICAgICAgIGZvcih2YXIgaSA9IDA7IGkgPCB0aGlzLl9lbnRpdHkuc3ByaXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2VudGl0eS5zcHJpdGVzW2ldLmtleSAhPSB1bmRlZmluZWQgJiYgX2RhdGEua2V5ID09IHRoaXMuX2VudGl0eS5zcHJpdGVzW2ldLmtleSkge1xuICAgICAgICAgICAgICAgIGlmKHRoaXMuX2VudGl0eS56b21iaWVNb2RlKXtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZW50aXR5LnNwcml0ZXNbaV0uc3ByaXRlLnBsYXlBbmltYXRpb24oIDgwLCAgMTAwLCB0cnVlLCAxMDApO1xuICAgICAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgICAgICBpZih0aGlzLl96b21iaWVNb2RlRW5hYmxlZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9lbnRpdHkuc3ByaXRlc1tpXS5zcHJpdGUucGxheUFuaW1hdGlvbihNYXRoLmFicyggMjAgLSBwYXJzZUludChfZGF0YS5kYXRhLnNwcml0ZUlEKSksICBwYXJzZUludChfZGF0YS5kYXRhLnNwcml0ZUlEKSwgdHJ1ZSwgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLl9lbnRpdHkuc3ByaXRlc1tpXS5zcHJpdGUucG9zaXRpb24gPSAgX2RhdGEuZGF0YS5wb3NpdGlvbjtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxufVxubW9kdWxlLmV4cG9ydHMgPSBzX211bHRpdXNlcjsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=